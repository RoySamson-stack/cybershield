"""Serializers for malware analysis"""
from rest_framework import serializers
from .models import (
    MalwareSample,
    VirusTotalAnalysis,
    BehavioralAnalysis,
    ThreatPattern,
    ThreatIntelligence
)


class MalwareSampleSerializer(serializers.ModelSerializer):
    """Serializer for malware samples"""
    class Meta:
        model = MalwareSample
        fields = [
            'id', 'file_name', 'file_size', 'file_type',
            'md5_hash', 'sha1_hash', 'sha256_hash',
            'status', 'is_malicious', 'threat_score',
            'threat_family', 'threat_type',
            'submitted_at', 'analyzed_at',
            'metadata', 'tags', 'created_at'
        ]
        read_only_fields = [
            'id', 'md5_hash', 'sha1_hash', 'sha256_hash',
            'status', 'is_malicious', 'threat_score',
            'submitted_at', 'analyzed_at', 'created_at'
        ]


class VirusTotalAnalysisSerializer(serializers.ModelSerializer):
    """Serializer for VirusTotal analysis"""
    class Meta:
        model = VirusTotalAnalysis
        fields = [
            'id', 'scan_id', 'permalink',
            'positives', 'total_engines', 'detection_ratio',
            'engine_results', 'scan_date',
            'first_seen', 'last_seen',
            'additional_info', 'created_at'
        ]
        read_only_fields = ['id', 'created_at']


class BehavioralAnalysisSerializer(serializers.ModelSerializer):
    """Serializer for behavioral analysis"""
    class Meta:
        model = BehavioralAnalysis
        fields = [
            'id', 'files_created', 'files_modified',
            'network_connections', 'dns_queries',
            'domains_contacted', 'processes_created',
            'iocs', 'analysis_duration',
            'sandbox_environment', 'created_at'
        ]
        read_only_fields = ['id', 'created_at']


class ThreatPatternSerializer(serializers.ModelSerializer):
    """Serializer for threat patterns"""
    class Meta:
        model = ThreatPattern
        fields = [
            'id', 'pattern_name', 'pattern_type',
            'description', 'indicators', 'techniques',
            'confidence_score', 'sample_count',
            'first_detected', 'last_seen',
            'is_trending', 'trend_score',
            'severity', 'tags', 'created_at'
        ]
        read_only_fields = ['id', 'created_at']


class ThreatIntelligenceSerializer(serializers.ModelSerializer):
    """Serializer for threat intelligence"""
    class Meta:
        model = ThreatIntelligence
        fields = [
            'id', 'title', 'description', 'summary',
            'threat_type', 'threat_family', 'severity',
            'iocs', 'techniques',
            'detection_timeline', 'affected_regions',
            'affected_industries', 'ml_insights',
            'prediction_confidence', 'source',
            'is_verified', 'tags', 'created_at'
        ]
        read_only_fields = ['id', 'created_at']






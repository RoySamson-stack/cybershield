"""Management command to generate threat intelligence"""
from django.core.management.base import BaseCommand
from apps.malware.services import ThreatIntelligenceService


class Command(BaseCommand):
    help = 'Generate threat intelligence from recent samples'

    def add_arguments(self, parser):
        parser.add_argument(
            '--days',
            type=int,
            default=7,
            help='Number of days to analyze (default: 7)',
        )

    def handle(self, *args, **options):
        days = options['days']
        
        self.stdout.write(f'Generating threat intelligence from last {days} days...')
        
        service = ThreatIntelligenceService()
        intelligence_items = service.generate_intelligence(days=days)
        
        self.stdout.write(
            self.style.SUCCESS(
                f'\nGenerated {len(intelligence_items)} threat intelligence items:\n'
            )
        )
        
        for item in intelligence_items:
            self.stdout.write(f'  - {item.title} ({item.severity})')








